# Голосовой чат (аналог Discord)

## 1. Тема и целевая аудитория

### Ключевой функционал
- Регистрация/Авторизация
- Профиль
- Личные голосовые чаты
- Групповые голосовые чаты 
- "Сервера" с несколькими голосовыми каналами

### Целевая аудитория
150 млн пользователей в месяц по всему миру  
- Северная Америка - 30%  
- Европа - 15%  
- Южная Америка - 12%

Остальное распределено по миру.

## 2. Расчет нагрузки

### Продуктовые метрики

| Метрика                                      | Значение |
| -------------------------------------------- | -------- |
| Зарегистрированных пользователей             | 500 млн  |
| Месячная аудитория                           | 150 млн  |
| Суточная аудитория                           | 20 млн   |
| Максимальное количество пользователей онлайн | 10 млн   |
| Минут голосового общения в месяц             | 4 млрд   |

### Среднее количество операций в день на пользователя по типам

| Операция                         | Среднее кол-во в день |
| -------------------------------- | :-------------------: |
| Авторизация                      |           2           |
| Смена аватара                    |          0.2          |
| Вход в голосовой чат/канал       |          10           |
| Получение списка участников чата |          20           |
| Получение списка чатов           |          10           |

### Технические метрики

Предлагаю для удобства объединить "Вход в голосовой чат", "Получение списка участников чата", "Получение списка чатов"
в один тип запросов, назовём её "Основные запросы"

Считаем средний RPS по формуле: `20 млн * N / 24 / 3600`, где N - число операций определённого типа

| Операция         | Средний RPS |
| ---------------- | :---------: |
| Авторизация      |     463     |
| Смена аватара    |     46      |
| Основные запросы |    9259     |

Положим битрейт звука - 96 кбит/с  
Учитывая 4 млрд голосового общения в месяц, суммарный суточный трафик для голосовых чатов:  
`4 млрд / 30 * 60 с * 96 кбит/с = 768 000 Гбит/сутки = 768 000 * 0.116 = 89 088 Гбайт/сутки`

##  Источники
1. https://discord.com/company
2. https://www.bankmycell.com/blog/number-of-discord-users
3. https://worldpopulationreview.com/country-rankings/discord-users-by-country
4. https://support.discord.com/hc/en-us/articles/11635925354775-Audio-Bitrate-FAQ
